[gd_scene load_steps=9 format=3 uid="uid://10wkwnw1ie5d"]

[ext_resource type="ArrayMesh" uid="uid://b6bs6nbv7d12w" path="res://NPCs/Hamster.tres" id="1_nd21d"]
[ext_resource type="Texture2D" uid="uid://t1iiumicgc1g" path="res://2DProps/Dialog.png" id="4_6alxn"]

[sub_resource type="GDScript" id="GDScript_drvn2"]
script/source = "extends RigidBody3D


# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	pass

func run():
	$Dialogue_box2/Sprite3D.hide()
	set_collision_layer_value(1,false)
	set_collision_mask_value(1,false)
	linear_velocity.x = 40
	angular_velocity.z = -10
"

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_p752j"]
points = PackedVector3Array(-0.000191808, 0.194933, 0.980785, -0.375379, 0.194933, 0.906093, -0.000191808, -0.195243, 0.980785, 0.375187, 0.194933, 0.906093, 0.204106, 0.905269, 0.731941, -0.204298, 0.905269, 0.731941, -0.693538, 0.194933, 0.693347, -0.375379, -0.195243, 0.906093, -0.386323, 0.905269, 0.695651, -0.540891, 0.905269, 0.592542, 0.375187, -0.195243, 0.906093, -0.000191808, -0.555786, 0.831402, 0.693347, 0.194933, 0.693347, 0.540699, 0.905269, 0.592542, 0.386131, 0.905269, 0.695651, 0.358482, 1.08017, 0.628639, 0.204106, 1.08017, 0.659361, -0.000191808, 1.53135, 0.494233, -0.000191808, 1.29225, 0.59331, -0.204298, 1.08017, 0.659361, -0.358674, 1.08017, 0.628639, -0.693538, -0.195243, 0.693347, -0.871723, 0.301847, 0.470616, -0.827561, -0.710346, 0.426645, -0.778599, -0.710346, 0.459287, -0.318352, -0.555786, 0.768038, -0.489624, 1.08017, 0.541275, -0.623071, 1.96801, -0.226955, -0.644, 0.905269, 0.437974, -0.917998, 0.301847, 0.401492, 0.693347, -0.195243, 0.693347, 0.31816, -0.555786, 0.768038, 0.778407, -0.710346, 0.459287, 0.82737, -0.710346, 0.426645, -0.212746, -0.831495, 0.513242, -0.000191808, -0.831495, 0.555484, 0.212555, -0.831495, 0.513242, 0.871532, 0.301847, 0.470616, 0.692771, 1.94187, -0.226955, 0.489433, 1.08017, 0.541275, 0.211019, 1.53135, 0.452183, 0.140935, 1.71438, 0.283214, -0.000191808, 1.71438, 0.311247, -0.141127, 1.71438, 0.283214, -0.21121, 1.53135, 0.452183, -0.871723, 0.217013, 0.470616, -0.917998, 0.217013, 0.401492, -0.906285, -0.195243, 0.375187, -0.860203, -0.710346, 0.377491, -0.839082, -0.765836, 0.36885, -0.81124, -0.765836, 0.410324, -0.769766, -0.765836, 0.437974, -0.753446, -0.808253, 0.398804, -0.389971, 1.53135, 0.332753, -0.934126, 0.301847, 0.319696, -0.000191808, 1.53135, -0.608671, -0.21121, 1.53135, -0.566813, -0.249036, 1.29225, -0.658209, -0.375379, 0.194933, -0.906286, -0.693538, 0.194933, -0.693539, -0.906285, 0.194933, -0.375379, -0.980785, 0.194933, -0.000192106, 0.906093, -0.195243, 0.375187, 0.871532, 0.217013, 0.470616, 0.753254, -0.808253, 0.398804, 0.769575, -0.765836, 0.437974, 0.811049, -0.765836, 0.410324, 0.83889, -0.765836, 0.36885, 0.860011, -0.710346, 0.377491, -0.0746915, -0.980825, 0.180105, -0.000191808, -0.980825, 0.195082, 0.0744999, -0.980825, 0.180105, 0.917614, 0.301847, 0.401492, 0.248845, 1.29225, -0.658209, 0.211019, 1.53135, -0.566813, 0.38978, 1.53135, 0.332753, 0.933935, 0.301847, 0.319696, 0.980785, 0.194933, -5.96046e-08, 0.906093, 0.194933, -0.375379, 0.693347, 0.194933, -0.693539, 0.375187, 0.194933, -0.906286, -0.934126, 0.217013, 0.319696, -0.980785, -0.195243, -0.000192106, -0.871723, -0.710346, 0.319696, -0.848874, -0.765836, 0.319696, -0.79972, -0.808253, 0.35253, -0.781287, -0.808253, 0.380371, -0.732324, -0.831204, 0.347537, -0.000191808, 1.29225, -0.707748, -0.000191808, 0.194933, -0.980785, -0.375379, -0.195243, -0.906286, -0.693538, -0.195243, -0.693539, -0.906285, -0.195243, -0.375379, 0.980785, -0.195243, -5.96046e-08, 0.933935, 0.217013, 0.319696, 0.917614, 0.217013, 0.401492, 0.871532, -0.710346, 0.319696, 0.781095, -0.808253, 0.380371, 0.732133, -0.831204, 0.347537, 0.799528, -0.808253, 0.35253, 0.848683, -0.765836, 0.319696, -0.138055, -0.980825, 0.137863, -0.000191808, -1, -5.96046e-08, 0.137863, -0.980825, 0.137863, 0.906093, -0.195243, -0.375379, 0.693347, -0.195243, -0.693539, 0.375187, -0.195243, -0.906286, -0.860203, -0.710346, 0.262093, -0.839082, -0.765836, 0.270733, -0.806248, -0.808253, 0.319696, -0.750757, -0.831204, 0.319696, -0.748453, -0.831204, 0.331217, -0.741925, -0.831204, 0.341009, -0.000191808, -0.195243, -0.980785, -0.000191808, -0.555786, -0.831594, -0.318352, -0.555786, -0.768231, -0.588125, -0.555786, -0.588126, -0.76823, -0.555786, -0.318352, 0.860011, -0.710346, 0.262093, 0.741733, -0.831204, 0.341009, 0.748262, -0.831204, 0.331217, 0.750566, -0.831204, 0.319696, 0.806056, -0.808253, 0.319696, 0.83889, -0.765836, 0.270733, -0.180297, -0.980825, 0.0744996, -0.000191808, -0.980825, -0.195274, 0.0744999, -0.980825, -0.180297, 0.137863, -0.980825, -0.138055, 0.180105, -0.980825, -0.0746918, 0.195082, -0.980825, -5.96046e-08, 0.180105, -0.980825, 0.0744996, -0.195274, -0.980825, -5.96046e-08, -0.180297, -0.980825, -0.0746918, -0.138055, -0.980825, -0.138055, -0.0746915, -0.980825, -0.180297, 0.768039, -0.555786, -0.318352, 0.587934, -0.555786, -0.588126, 0.31816, -0.555786, -0.768231, -0.79972, -0.808253, 0.287054, -0.513433, -0.831495, -0.212747, -0.748453, -0.831204, 0.308367, 0.212555, -0.831495, -0.513434, 1.78814e-07, -0.831495, -0.555676, -0.212746, -0.831495, -0.513434, -0.392851, -0.831495, -0.392852, 0.748262, -0.831204, 0.308367, 0.799528, -0.808253, 0.287054, 0.513242, -0.831495, -0.212747, 0.39266, -0.831495, -0.392852)

[sub_resource type="Animation" id="Animation_r1bs4"]
resource_name = "Talk"
length = 1.04167
loop_mode = 1
tracks/0/type = "position_3d"
tracks/0/imported = true
tracks/0/enabled = true
tracks/0/path = NodePath("Cachetes, pies y manos")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = PackedFloat32Array(0, 1, 0, 0, 0, 0.0333333, 1, 0, 0, 0, 0.0666667, 1, 0, 0.0703125, 0, 0.1, 1, 0, 0.220312, 0, 0.166667, 1, 0, 0.632813, 0, 0.2, 1, 0, 0.726563, 0, 0.233333, 1, 0, 0.7032, 0, 0.266667, 1, 0, 0.5976, 0, 0.3, 1, 0, 0.4416, 0, 0.333333, 1, 0, 0.264, 0, 0.366667, 1, 0, 0.1152, 0, 0.4, 1, 0, 0.0312, 0, 0.433333, 1, 0, 0.0312, 0, 0.466667, 1, 0, 0.1152, 0, 0.5, 1, 0, 0.264, 0, 0.533333, 1, 0, 0.4416, 0, 0.566667, 1, 0, 0.5976, 0, 0.6, 1, 0, 0.7032, 0, 0.633333, 1, 0, 0.7344, 0, 0.666667, 1, 0, 0.672, 0, 0.7, 1, 0, 0.5232, 0, 0.733333, 1, 0, 0.3528, 0, 0.766667, 1, 0, 0.1896, 0, 0.8, 1, 0, 0.0624001, 0, 0.866667, 1, 0, 0.0624, 0, 0.9, 1, 0, 0.1896, 0, 0.933333, 1, 0, 0.3528, 0, 0.966667, 1, 0, 0.5232, 0, 1, 1, 0, 0.672, 0, 1.04167, 1, 0, 0.75, 0)

[sub_resource type="AnimationLibrary" id="AnimationLibrary_l16p6"]
_data = {
"Talk": SubResource("Animation_r1bs4")
}

[sub_resource type="GDScript" id="GDScript_hqvrq"]
script/source = "extends Area3D
var Handready = false
var state = false
@export var lines: Array[String] =[
	\"Hey, you seem pretty strong!\",
	\"Wanna spar?\",
	\"Wait...\",
	\"I shouldn't waste my energy before an important battle...\",
	\"Well, I'll see you at the buffet!\",]
	

func _unhandled_input(event):
	if state and event.is_action_pressed(\"Talk\"):
		Handready = true
		$Sprite3D.hide()
		DialogManager.start_dialog(global_position, lines)
		state = false


func _on_body_entered(body):
	if body.name == \"Player\":
		$Sprite3D.show()
		state = true


func _on_body_exited(body):
	if body.name == \"Player\":
		state = false
		$Sprite3D.hide()
"

[sub_resource type="BoxShape3D" id="BoxShape3D_bgy1i"]
size = Vector3(5, 5, 5)

[node name="Hamster" type="RigidBody3D"]
axis_lock_linear_y = true
axis_lock_linear_z = true
axis_lock_angular_x = true
axis_lock_angular_y = true
script = SubResource("GDScript_drvn2")

[node name="Cachetes, pies y manos" type="MeshInstance3D" parent="."]
mesh = ExtResource("1_nd21d")
skeleton = NodePath("")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("ConvexPolygonShape3D_p752j")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_l16p6")
}

[node name="Dialogue_box2" type="Area3D" parent="."]
process_mode = 3
transform = Transform3D(4, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0)
script = SubResource("GDScript_hqvrq")
lines = Array[String](["This is a test", "It should be printing now...", "RUN!!!"])

[node name="CollisionShape3D" type="CollisionShape3D" parent="Dialogue_box2"]
shape = SubResource("BoxShape3D_bgy1i")

[node name="Sprite3D" type="Sprite3D" parent="Dialogue_box2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.24, 0)
visible = false
billboard = 1
texture_filter = 0
texture = ExtResource("4_6alxn")

[connection signal="body_entered" from="Dialogue_box2" to="Dialogue_box2" method="_on_body_entered" flags=18]
[connection signal="body_exited" from="Dialogue_box2" to="Dialogue_box2" method="_on_body_exited" flags=18]
